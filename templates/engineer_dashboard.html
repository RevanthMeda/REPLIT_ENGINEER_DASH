{% extends "base_unified.html" %}
{% import 'macros.html' as macros %}

{% block title %}Engineer Dashboard{% endblock %}
{% block body_class %}dashboard-layout{% endblock %}

{% block navigation %}
  {{ macros.nav_link(url_for('dashboard.engineer'), 'tachometer-alt', 'Dashboard', active=true) }}
  {{ macros.nav_link(url_for('reports.new'), 'plus-circle', 'Create Report', featured=true) }}
  {{ macros.nav_link(url_for('dashboard.my_reports'), 'folder-open', 'My Reports') }}
  {{ macros.nav_link(url_for('io_builder.index'), 'sitemap', 'I/O Builder') }}
  {{ macros.nav_link(url_for('notifications.notification_center'), 'bell', 'Notifications', badge_count=unread_count if unread_count is defined else 0) }}
{% endblock %}

{% block content_header %}
  <div class="dashboard-header">
    <div class="header-content">
      <div class="header-info">
        <h1><i class="fas fa-hard-hat"></i> Engineer Dashboard</h1>
        <p class="subtitle">Welcome back, {{ current_user.full_name or 'Engineer' }}! Ready to create your next report?</p>
      </div>
      <img src="{{ url_for('static', filename='img/cully.png') }}" alt="Cully Logo" class="header-logo">
    </div>
  </div>
{% endblock %}

{% block content %}
  <!-- Stats Overview -->
  <div class="stats-grid">
    {{ macros.stat_card('file-alt', stats.total_reports if stats else 0, 'Total Reports') }}
    {{ macros.stat_card('clock', stats.pending_reports if stats else 0, 'Pending Approval') }}
    {{ macros.stat_card('check-circle', stats.approved_reports if stats else 0, 'Approved Reports') }}
  </div>

  <!-- Quick Actions -->
  {% call macros.widget_card('Quick Actions', 'rocket') %}
    <div class="action-grid">
      {{ macros.action_card(url_for('reports.new'), 'plus-circle', 'Create Report', 'Start a new SAT report for site testing and validation', 'Ready') }}
      {{ macros.action_card(url_for('dashboard.my_reports'), 'folder-open', 'View Reports', 'Access and manage all your submitted reports') }}
      {{ macros.action_card(url_for('io_builder.index'), 'sitemap', 'I/O Builder', 'Generate I/O lists from component specifications') }}
      {{ macros.action_card(url_for('notifications.notification_center'), 'bell', 'Notifications', 'Check updates and approval status') }}
    </div>
  {% endcall %}

  <!-- Recent Activity -->
  {% call macros.widget_card('Recent Activity', 'history') %}
    {% if recent_activity %}
      <div class="activity-summary">
        {% for activity in recent_activity %}
          <div class="activity-item">
            <div class="activity-icon {% if activity.type == 'warning' %}warning{% elif activity.type == 'success' %}success{% endif %}">
              <i class="fa fa-{{ activity.icon }}"></i>
            </div>
            <div class="activity-content">
              <h4>{{ activity.title }}</h4>
              <p>{{ activity.description }}</p>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      {{ macros.empty_state('inbox', 'No Recent Activity', 'Start by creating your first SAT report', url_for('reports.new'), 'Create Report', 'plus-circle') }}
    {% endif %}
  {% endcall %}
{% endblock %}